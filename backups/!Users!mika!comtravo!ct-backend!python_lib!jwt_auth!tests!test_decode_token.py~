from jose.jwt import encode
from unittest import TestCase
from unittest.mock import patch
from jwt_auth.verify import decode_payload


@patch('jwt_auth.get_keys.get_public_keys', return_value={'key': 'secret'})
class TestEncode(TestCase):
    def test_decode(self):
        token = encode({'test': 'test'}, 'secret', algorithm='RS256')
        self.assertEquals({'test': 'test'}, decode_payload(token))
        

