# nlp_tools_server

A mini webservice that returns duckling and Stanford CoreNLP predictions on a string - see https://duckling.wit.ai/ for duckling and http://stanfordnlp.github.io/CoreNLP/ for CoreNLP.

## Prerequisites

You will need [Leiningen][] 2.0.0 or above installed.

[leiningen]: https://github.com/technomancy/leiningen

This also currently depends on a fork of duckling; I push back my changes/improvements to the wit.ai master branch, but there might be more recent things going on.

## Running

To start a web server for the application, run:

    lein ring server

## Test

There are two endpoints, `POST /duckling` and `POST /corenlp`.

Server expects a json payload with fields `"text": "..."`, `"date": 123456789` (only duckling) and `"lang": "de"|"en"`, where `date` is miliseconds since the UTC epoch.

`curl -X POST -H "Content-Type: application/json" -d '{"text": "Am 1. Mai kostet der Flug f√ºr 2 Wochen 100EUR", "lang": "de", "date": 1466496440316}' http://localhost:3000/duckling`

Gives a json with

```json
{
  "result" : {
    "duckling" : [ {
      "dim" : "number",
      "body" : "100",
      "value" : {
        "type" : "value",
        "value" : 100
      },
      "start" : 39,
      "end" : 42
    }, {
      "dim" : "time",
      "body" : "100",
      "value" : {
        "type" : "value",
        "value" : "2016-06-15T01:00:00.000+02:00",
        "grain" : "minute",
        "values" : [ {
          "type" : "value",
          "value" : "2016-06-15T01:00:00.000+02:00",
          "grain" : "minute"
        }, {
          "type" : "value",
          "value" : "2016-06-16T01:00:00.000+02:00",
          "grain" : "minute"
        }, {
          "type" : "value",
          "value" : "2016-06-17T01:00:00.000+02:00",
          "grain" : "minute"
        } ]
      },
      "start" : 39,
      "end" : 42,
      "latent" : true
    }, {
      "dim" : "duration",
      "body" : "2 Wochen",
      "value" : {
        "week" : 2,
        "value" : 2,
        "unit" : "week",
        "normalized" : {
          "value" : 1209600,
          "unit" : "second"
        }
      },
      "start" : 30,
      "end" : 38
    }, {
      "dim" : "time",
      "body" : "Am 1. Mai",
      "value" : {
        "type" : "value",
        "value" : "2017-05-01T00:00:00.000+02:00",
        "grain" : "day",
        "values" : [ {
          "type" : "value",
          "value" : "2017-05-01T00:00:00.000+02:00",
          "grain" : "day"
        }, {
          "type" : "value",
          "value" : "2018-05-01T00:00:00.000+02:00",
          "grain" : "day"
        }, {
          "type" : "value",
          "value" : "2019-05-01T00:00:00.000+02:00",
          "grain" : "day"
        } ]
      },
      "start" : 0,
      "end" : 9
    } ]
  },
  "status" : 200
}```